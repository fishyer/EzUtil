apply plugin: 'maven'

Properties properties = new Properties();
properties.load(new FileInputStream(file("../local.properties")))

def userName = properties.userName
def password = properties.password

def lib_url = properties.lib_url
def lib_groupId = properties.lib_groupId
def lib_artifactId = properties.lib_artifactId
def lib_version = getGitCommitCount()

println("lib_url:" + lib_url)
println("lib_groupId:" + lib_groupId)
println("lib_artifactId:" + lib_artifactId)
println("lib_version:" + lib_version)

def getGitCommitCount() {
    return 'git rev-list HEAD --first-parent --count'.execute().text.trim().toInteger()
}

uploadArchives {
    configuration = configurations.archives

    repositories.mavenDeployer {
        repository(url: lib_url) {
            authentication(userName: userName, password: password)
        }

        pom.project {
            groupId lib_groupId
            artifactId lib_artifactId
            version lib_version
            packaging 'aar'
            description 'none'
        }
    }

}